<!DOCTYPE html>
<html lang="de" data-theme="dark">
<head>
  <meta charset="UTF-8">
  <title>Login • Slot Manager</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo.png') }}">

  <!-- Tailwind CSS + DaisyUI -->
  <script src="{{ url_for('static', filename='tailwind.min.js') }}"></script>
  <link href="{{ url_for('static', filename='daisyui.min.css') }}" rel="stylesheet" type="text/css" />

  <!-- Lucide Icons -->
  <script src="{{ url_for('static', filename='lucide.js') }}"></script>

  <!-- Particles.js -->
  <script src="{{ url_for('static', filename='particles.min.js') }}"></script>

  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'primary': '#5ab1ff',
            'secondary': '#10b981',
            'accent': '#f97316',
          },
        },
      },
    }
  </script>

  <style>
    @import url('http://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', sans-serif;
      overflow: hidden;
    }

    /* Animated Background Gradient */
    .gradient-bg {
      background: linear-gradient(-45deg, #667eea, #764ba2, #f093fb, #4facfe);
      background-size: 400% 400%;
      animation: gradient 15s ease infinite;
    }

    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* Glassmorphism Card */
    .glass-card {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(30px) saturate(180%);
      -webkit-backdrop-filter: blur(30px) saturate(180%);
      border: 1px solid rgba(255, 255, 255, 0.2);
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.4);
    }

    /* Particle Container */
    #particles-js {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      z-index: 0;
    }

    /* Float Animation */
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-20px); }
    }

    .float-animation {
      animation: float 6s ease-in-out infinite;
    }

    /* Input Focus Glow */
    .input-glow:focus {
      box-shadow: 0 0 30px rgba(90, 177, 255, 0.5);
    }

    /* Button Hover Effect */
    .btn-primary-custom {
      background: linear-gradient(135deg, #5ab1ff 0%, #2196F3 100%);
      transition: all 0.3s ease;
    }

    .btn-primary-custom:hover {
      transform: translateY(-2px);
      box-shadow: 0 20px 40px rgba(90, 177, 255, 0.4);
    }
  </style>
</head>
<body class="gradient-bg min-h-screen flex items-center justify-center p-4">

  <!-- Particle Background -->
  <div id="particles-js"></div>

  <!-- Login Container -->
  <div class="relative z-10 w-full max-w-md">

    <!-- Logo & Title -->
    <div class="text-center mb-8 float-animation">
      <div class="inline-flex items-center justify-center w-24 h-24 rounded-3xl bg-white/10 backdrop-blur-xl border border-white/20 mb-6">
        <i data-lucide="shield-check" class="w-12 h-12 text-primary"></i>
      </div>
      <h1 class="text-4xl font-bold text-white mb-2">Business Tool Hub</h1>
      <p class="text-white/70">Sichere Anmeldung erforderlich</p>
    </div>

    <!-- Login Card -->
    <div class="glass-card rounded-3xl p-8 md:p-10">

      <!-- Error Message -->
      {% if error %}
      <div class="mb-6 p-4 rounded-xl bg-error/20 border border-error/50 flex items-center gap-3">
        <i data-lucide="alert-circle" class="w-5 h-5 text-error"></i>
        <p class="text-error text-sm">{{ error }}</p>
      </div>
      {% endif %}

      <!-- Login Form -->
      <form method="POST" action="{{ url_for('auth.login') }}" class="space-y-6">

        <!-- Username -->
        <div>
          <label class="block text-white/90 font-semibold mb-2 flex items-center gap-2">
            <i data-lucide="user" class="w-4 h-4"></i>
            Benutzername
          </label>
          <input
            type="text"
            name="username"
            required
            class="input-glow w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-primary transition-all"
            placeholder="Benutzername eingeben"
            autocomplete="username">
        </div>

        <!-- Password -->
        <div>
          <label class="block text-white/90 font-semibold mb-2 flex items-center gap-2">
            <i data-lucide="lock" class="w-4 h-4"></i>
            Passwort
          </label>
          <div class="relative">
            <input
              type="password"
              name="password"
              required
              id="password-input"
              class="input-glow w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-primary transition-all pr-12"
              placeholder="Passwort eingeben"
              autocomplete="current-password">
            <button
              type="button"
              onclick="togglePassword()"
              class="absolute right-4 top-1/2 -translate-y-1/2 text-white/50 hover:text-white transition-colors">
              <i data-lucide="eye" id="eye-icon" class="w-5 h-5"></i>
            </button>
          </div>
        </div>

        <!-- 2FA Code (nur anzeigen wenn aktiviert) -->
        {% if show_2fa %}
        <div>
          <label class="block text-white/90 font-semibold mb-2 flex items-center gap-2">
            <i data-lucide="shield" class="w-4 h-4"></i>
            2FA-Code
          </label>
          <input
            type="text"
            name="totp_code"
            required
            maxlength="6"
            pattern="[0-9]{6}"
            class="input-glow w-full px-4 py-3 rounded-xl bg-white/10 border border-white/20 text-white placeholder-white/50 focus:outline-none focus:border-primary transition-all text-center text-2xl tracking-widest"
            placeholder="000000"
            autocomplete="one-time-code">
          <p class="text-xs text-white/50 mt-2">Code aus deiner Authenticator-App oder Backup-Code</p>
          {% if username %}
          <input type="hidden" name="username" value="{{ username }}">
          <input type="hidden" name="password" value="{{ password }}">
          {% endif %}
        </div>
        {% endif %}

        <!-- Remember Me -->
        <div class="flex items-center">
          <input
            type="checkbox"
            id="remember"
            class="checkbox checkbox-primary border-white/20">
          <label for="remember" class="ml-3 text-white/70 text-sm cursor-pointer">
            Angemeldet bleiben
          </label>
        </div>

        <!-- Login Button -->
        <button
          type="submit"
          class="btn-primary-custom w-full py-4 rounded-xl text-white font-bold text-lg shadow-2xl">
          <span class="flex items-center justify-center gap-2">
            <i data-lucide="log-in" class="w-5 h-5"></i>
            Anmelden
          </span>
        </button>

      </form>

      <!-- Footer Links -->
      <div class="mt-8 pt-6 border-t border-white/10">
        <div class="flex items-center justify-between text-sm">
          <a href="#" class="text-white/60 hover:text-primary transition-colors flex items-center gap-2">
            <i data-lucide="help-circle" class="w-4 h-4"></i>
            Hilfe benötigt?
          </a>
          <a href="/health" class="text-white/60 hover:text-secondary transition-colors flex items-center gap-2">
            <i data-lucide="activity" class="w-4 h-4"></i>
            System Status
          </a>
        </div>
      </div>

    </div>

    <!-- Version Info -->
    <div class="text-center mt-6 text-white/50 text-sm">
      <p>Business Tool Hub v3.2</p>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // Initialize Lucide Icons
    lucide.createIcons();

    // Initialize Particles.js
    particlesJS('particles-js', {
      particles: {
        number: { value: 100, density: { enable: true, value_area: 800 } },
        color: { value: '#ffffff' },
        shape: { type: 'circle' },
        opacity: {
          value: 0.3,
          random: true,
          anim: { enable: true, speed: 1, opacity_min: 0.1, sync: false }
        },
        size: {
          value: 3,
          random: true,
          anim: { enable: true, speed: 2, size_min: 0.1, sync: false }
        },
        line_linked: {
          enable: true,
          distance: 150,
          color: '#ffffff',
          opacity: 0.2,
          width: 1
        },
        move: {
          enable: true,
          speed: 1.5,
          direction: 'none',
          random: true,
          straight: false,
          out_mode: 'out',
          bounce: false
        }
      },
      interactivity: {
        detect_on: 'canvas',
        events: {
          onhover: { enable: true, mode: 'grab' },
          onclick: { enable: true, mode: 'push' },
          resize: true
        },
        modes: {
          grab: { distance: 200, line_linked: { opacity: 0.5 } },
          push: { particles_nb: 4 }
        }
      },
      retina_detect: true
    });

    // Toggle Password Visibility
    function togglePassword() {
      const passwordInput = document.getElementById('password-input');
      const eyeIcon = document.getElementById('eye-icon');

      if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        eyeIcon.setAttribute('data-lucide', 'eye-off');
      } else {
        passwordInput.type = 'password';
        eyeIcon.setAttribute('data-lucide', 'eye');
      }

      lucide.createIcons();
    }

    // Form Animation on Submit
    document.querySelector('form').addEventListener('submit', function(e) {
      const btn = this.querySelector('button[type="submit"]');
      btn.innerHTML = '<span class="loading loading-spinner"></span> Anmelden...';
      btn.disabled = true;
    });

    // Auto-focus on username
    document.querySelector('input[name="username"]').focus();
  </script>
</body>
</html>
